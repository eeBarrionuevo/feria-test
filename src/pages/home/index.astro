---
import BasicLayout from "../../layouts/BasicLayout.astro";
import { companies, events, recommendations, webinarsByDate } from "../../data/data"; //
import CompanyItem from "../../components/company/CompanyItem.astro";
import WebinarNowItem from "../../components/webinar/WebinarNowItem.astro";
import WebinarItem from "../../components/webinar/WebinarItem.astro";
import RecommendationItem from "../../components/recommendation/RecommendationItem.astro";
import WebinarAccordionItem from "../../components/webinar/WebinarAccordionItem.astro";
---

<BasicLayout>
  <section
    class="max-w-6xl mx-auto text-white px-6 py-10 md:px-6 md:py-20"
    aria-label="SecciÃ³n de informaciÃ³n general de la feria virtual de Alumni Tecsup"
  >
    <div>
      <h2
        class="text-2xl md:text-3xl font-extrabold leading-tight font-al mb-4"
      >
        Explora las y participa en los webinars
      </h2>

      <div class="flex items-center gap-4">
        <button
          id="btn-empresas"
          class="bg-black w-fit px-8 py-4 rounded-xl shadow-lg hover:bg-black/40"
          onclick="showTab('empresas')"
        >
          <div class="flex items-center justify-center gap-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-6 h-6"
              viewBox="0 0 24 24"
              style="fill: rgb(255, 255, 255);transform: ;msFilter:;"
              ><path
                d="M19 2H9c-1.103 0-2 .897-2 2v5.586l-4.707 4.707A1 1 0 0 0 3 16v5a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V4c0-1.103-.897-2-2-2zm-8 18H5v-5.586l3-3 3 3V20zm8 0h-6v-4a.999.999 0 0 0 .707-1.707L9 9.586V4h10v16z"
              ></path><path
                d="M11 6h2v2h-2zm4 0h2v2h-2zm0 4.031h2V12h-2zM15 14h2v2h-2zm-8 1h2v2H7z"
              ></path></svg
            >
            Empresas
          </div>
        </button>

        <button
          id="btn-webinars"
          class="w-fit px-8 py-4 rounded-xl border-2 border-dashed border-gray-50 overflow-hidden shadow"
          onclick="showTab('webinars')"
        >
          <div class="flex items-center justify-center gap-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-6 h-6"
              viewBox="0 0 24 24"
              style="fill: rgb(255, 255, 255);transform: ;msFilter:;"
              ><path
                d="M20 3H4c-1.103 0-2 .897-2 2v11c0 1.103.897 2 2 2h7v2H8v2h8v-2h-3v-2h7c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2zM4 14V5h16l.002 9H4z"
              ></path></svg
            >
            Webinars
          </div>
        </button>
      </div>

      <div
        id="empresas"
        class="flex flex-col md:flex-row items-start justify-center gap-4 mt-6"
      >
        <div
          class="flex-[4] w-full items-center justify-center bg-white/10 rounded-xl p-4"
        >
          <div>
            <input
              id="email"
              type="email"
              placeholder="Buscar empresa..."
              class="w-full mb-4 bg-white text-sm rounded-lg h-10 px-2 placeholder-gray-500 focus:outline-none focus:ring-2"
            />
          </div>

          <div
            class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"
          >
            {
              companies.map((item) => (
                <CompanyItem
                  href="/home/1/"
                  image={item.image}
                  company={item.company}
                  opportunities={item.opportunities}
                />
              ))
            }
          </div>
        </div>

        <div class="flex-[1] w-full bg-white/10 rounded-xl p-4">
          <div class="text-lg font-bold mb-4">Â¡Tu webinar de ahora!</div>

          <WebinarNowItem
            title="Potencia tu perfil en LinkedIn y atrae reclutadores"
            companyLogo="https://images.pexels.com/photos/1181686/pexels-photo-1181686.jpeg"
            company="Ferreyros"
            date="20 de noviembre"
            time="13:00"
            href="/audience"
          />

          <div class="text-lg font-bold leading-5 my-6">
            Recomendaciones para iniciar tu camino laboral
          </div>

          {
            recommendations.map((item) => (
              <RecommendationItem
                title={item.title}
                description={item.description}
              />
            ))
          }
        </div>
      </div>

      <!-- Webinars -->

      <div
        id="webinars"
        class="flex flex-col md:flex-row items-start justify-center gap-4 mt-6 hidden"
      >
        <div
          class="flex-[4] w-full flex-col items-center bg-white/10 rounded-xl px-4 py-8"
        >
          {webinarsByDate.map((group) => <WebinarAccordionItem {...group} />)}
        </div>

        <div class="flex-[1] w-full bg-white/10 rounded-xl p-4">
          <div class="text-lg font-bold mb-4">Â¡Tu webinar de ahora!</div>

          <WebinarNowItem
            title="Potencia tu perfil en LinkedIn y atrae reclutadores"
            companyLogo="https://images.pexels.com/photos/1181686/pexels-photo-1181686.jpeg"
            company="Ferreyros"
            date="20 de noviembre"
            time="13:00"
            href="/audience"
          />

          <div class="text-lg font-bold leading-5 my-6">
            Recomendaciones para iniciar tu camino laboral
          </div>

          {
            recommendations.map((item) => (
              <RecommendationItem
                title={item.title}
                description={item.description}
              />
            ))
          }
        </div>
      </div>
    </div>
  </section>

  <!-- <div class="w-full max-w-md mx-auto">
    <div
      class="accordion border-2 border-dashed border-gray-400 rounded-xl mb-3"
    >
      <button
        class="accordion-btn w-full flex justify-between items-center px-4 py-3 text-left font-medium text-gray-700"
      >
        Â¿QuÃ© es Astro?
        <span class="icon transform transition-transform duration-300">â–¼</span>
      </button>
      <div
        class="accordion-content overflow-hidden transition-all duration-500 ease-in-out max-h-0 opacity-0"
      >
        <div class="px-4 pb-4 text-gray-600">
          Astro es un framework moderno que combina la simplicidad de HTML con
          el poder de componentes. Permite crear sitios rÃ¡pidos con renderizado
          hÃ­brido.
        </div>
      </div>
    </div>

    <div
      class="accordion border-2 border-dashed border-gray-400 rounded-xl mb-3"
    >
      <button
        class="accordion-btn w-full flex justify-between items-center px-4 py-3 text-left font-medium text-gray-700"
      >
        Â¿QuÃ© es Tailwind?
        <span class="icon transform transition-transform duration-300">â–¼</span>
      </button>
      <div
        class="accordion-content overflow-hidden transition-all duration-500 ease-in-out max-h-0 opacity-0"
      >
        <div class="px-4 pb-4 text-gray-600">
          Tailwind es un framework CSS utility-first que permite construir
          diseÃ±os modernos con clases predefinidas, sin necesidad de escribir
          CSS desde cero.
        </div>
      </div>
    </div>
  </div> -->

  <script type="module">

    document.querySelectorAll(".accordion-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        const content = btn.nextElementSibling;
        const icon = btn.querySelector(".icon");

        if (!content) return;

        if (content.style.maxHeight && content.style.maxHeight !== "0px") {
          // ðŸ”½ cerrar
          content.style.maxHeight = "0px";
          content.classList.remove("opacity-100");
          content.classList.add("opacity-0");
          if (icon) icon.classList.remove("rotate-180");
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          content.classList.remove("opacity-0");
          content.classList.add("opacity-100");
          if (icon) icon.classList.add("rotate-180");
        }
      });
    });

    function showTab(tab) {
      const sections = ["empresas", "webinars"];

      sections.forEach((id) => {
        const el = document.getElementById(id);
        if (!el) return;
        if (id === tab) {
          el.classList.remove("hidden");
        } else {
          el.classList.add("hidden");
        }
      });

      document.querySelectorAll("[data-tab]").forEach((btn) => {
        if (btn.getAttribute("data-tab") === tab) {
          btn.classList.add("bg-blue-600");
          btn.classList.remove("bg-gray-700");
        } else {
          btn.classList.remove("bg-blue-600");
          btn.classList.add("bg-gray-700");
        }
      });
    }

    window.showTab = showTab;
  </script>
</BasicLayout>
